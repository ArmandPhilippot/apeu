---
import { getStoryMeta } from "../../../utils/stories";
import Heading from "../../atoms/heading/heading.astro";
import PageLayout from "../../templates/page-layout/page-layout.astro";
import CodePreview from "../code-preview/code-preview.astro";
import CodeBlockComponent from "./code-block.astro";

const title = "CodeBlock";
const { breadcrumb, seo } = getStoryMeta({
  breadcrumb: {
    kind: "molecules",
    route: Astro.url.pathname,
    title,
  },
});

const jsCodeSample = `
console.log("Hello world!");
const foo = 42;
`;

const commandLineCodeSample = `
git add README.md
git commit -m "Added documentation"
`;

const sqlCodeSample = `
ALTER USER 'root'@'localhost'
`;

const diffCodeSample = `
const breadcrumb = [
  { label: 'Home', slug: '/' },
  { label: 'Design system', slug: '/design-system' },
-  { label: 'Foo', slug: '/design-system/foo' },
+  { label: 'Components', slug: '/design-system/components' },
  { label: 'Molecules', slug: '/design-system/components/molecules' },
  {
    label: title,
    slug: '/design-system/components/molecules/code-blocks',
  },
];
`;

const complexDiffCodeSample = `
.container {
-  display: "block";
+  display: "flex";
+  flex-flow: row wrap;
+  align-items: "center";
  margin: 0;
-  padding: 1px;
-  font-size: 10px;
+  padding: 5px;
  position: relative;
}
`;
---

<PageLayout breadcrumb={breadcrumb} seo={seo} title={title}>
  <Fragment slot="body">
    <Heading>Introduction</Heading>
    <CodePreview
      code={`import CodeBlock from "./components/molecules/code-block/code-block.astro";`}
      label="How to import"
      lang="ts"
    />
    <CodePreview
      code={`<CodeBlock code={jsCodeSample} />`}
      label="Basic use"
      lang="astro"
    >
      <CodeBlockComponent code={jsCodeSample} />
    </CodePreview>
    <Heading as="h2">With lang</Heading>
    <CodePreview
      code={`<CodeBlock code={jsCodeSample} lang="js" />`}
      label="Using a lang"
      lang="astro"
    >
      <CodeBlockComponent code={jsCodeSample} lang="js" />
    </CodePreview>
    <Heading as="h2">With file path</Heading>
    <CodePreview
      code={`<CodeBlock code={jsCodeSample} filePath="./hello-world.js" lang="js" />`}
      label="Using a lang with a file path"
      lang="astro"
    >
      <CodeBlockComponent
        code={jsCodeSample}
        filePath="./hello-world.js"
        lang="js"
      />
    </CodePreview>
    <Heading as="h2">With line numbers</Heading>
    <CodePreview
      code={`<CodeBlock code={jsCodeSample} lang="js" showLineNumbers />`}
      label="Using line numbers"
      lang="astro"
    >
      <CodeBlockComponent code={jsCodeSample} lang="js" showLineNumbers />
    </CodePreview>
    <Heading as="h2">With line numbers and custom starting line</Heading>
    <CodePreview
      code={`<CodeBlock
  code={jsCodeSample}
  lang="js"
  lineStart={5}
  showLineNumbers
/>`}
      label="Using line numbers with a custom starting line"
      lang="astro"
    >
      <CodeBlockComponent
        code={jsCodeSample}
        lang="js"
        lineStart={5}
        showLineNumbers
      />
    </CodePreview>
    <Heading as="h2">With prompt</Heading>
    <CodePreview
      code={`<CodeBlock code={commandLineCodeSample} lang="shell" showPrompt />`}
      label="Using a prompt"
      lang="astro"
    >
      <CodeBlockComponent
        code={commandLineCodeSample}
        lang="shell"
        showPrompt
      />
    </CodePreview>
    <Heading as="h2">With prompt and custom username</Heading>
    <CodePreview
      code={`<CodeBlock
  code={commandLineCodeSample}
  lang="shell"
  promptUser="john"
  showPrompt
/>`}
      label="Using a prompt with a custom user"
      lang="astro"
    >
      <CodeBlockComponent
        code={commandLineCodeSample}
        lang="shell"
        promptUser="john"
        showPrompt
      />
    </CodePreview>
    <Heading as="h2">With prompt and custom host</Heading>
    <CodePreview
      code={`<CodeBlock
  code={commandLineCodeSample}
  lang="shell"
  promptHost="doe"
  promptUser="john"
  showPrompt
/>`}
      label="Using a prompt with a custom host"
      lang="astro"
    >
      <CodeBlockComponent
        code={commandLineCodeSample}
        lang="shell"
        promptHost="doe"
        promptUser="john"
        showPrompt
      />
    </CodePreview>
    <CodeBlockComponent
      code={commandLineCodeSample}
      lang="shell"
      promptHost="doe"
      promptUser="john"
      showPrompt
    />
    <Heading as="h2">With prompt as root</Heading>
    <CodePreview
      code={`<CodeBlock
  code={commandLineCodeSample}
  lang="shell"
  promptUser="root"
  showPrompt
/>`}
      label="Using a prompt as root"
      lang="astro"
    >
      <CodeBlockComponent
        code={commandLineCodeSample}
        lang="shell"
        promptUser="root"
        showPrompt
      />
    </CodePreview>
    <Heading as="h2">With SQL prompt</Heading>
    <CodePreview
      code={`<CodeBlock code={sqlCodeSample} lang="sql" showPrompt />`}
      label="Using an SQL prompt"
      lang="astro"
    >
      <CodeBlockComponent code={sqlCodeSample} lang="sql" showPrompt />
    </CodePreview>
    <Heading as="h2">With SQL prompt and custom prompt host</Heading>
    <CodePreview
      code={`<CodeBlock code={sqlCodeSample} lang="sql" promptHost="MariaDB" showPrompt />`}
      label="Using a prompt with a custom host"
      lang="astro"
    >
      <CodeBlockComponent
        code={sqlCodeSample}
        lang="sql"
        promptHost="MariaDB"
        showPrompt
      />
    </CodePreview>
    <Heading as="h2">With SQL prompt and custom database name</Heading>
    <CodePreview
      code={`<CodeBlock code={sqlCodeSample} lang="sql" promptDB="recipes" showPrompt />`}
      label="Using a prompt with a custom database"
      lang="astro"
    >
      <CodeBlockComponent
        code={sqlCodeSample}
        lang="sql"
        promptDB="recipes"
        showPrompt
      />
    </CodePreview>
    <Heading as="h2">Diff</Heading>
    <CodePreview
      code={`<CodeBlock code={diffCodeSample} lang="diff" showLineNumbers />`}
      label="Using a diff"
      lang="astro"
    >
      <CodeBlockComponent code={diffCodeSample} lang="diff" showLineNumbers />
    </CodePreview>
    <Heading as="h2">Diff with syntax highlighting</Heading>
    <CodePreview
      code={`<CodeBlock code={diffCodeSample} isDiff lang="ts" showLineNumbers />`}
      label="Using a diff with syntax highlighting"
      lang="astro"
    >
      <CodeBlockComponent
        code={diffCodeSample}
        isDiff
        lang="ts"
        showLineNumbers
      />
    </CodePreview>
    <Heading as="h2">Limitations</Heading>
    <p>
      Ideally, I'd like that removed lines affects the line numbers for the next
      lines but due to <code>counter</code> limitations, it seems impossible with
      CSS only when having multiple removed lines at once. So this type of blocks
      should be avoided.
    </p>
    <CodePreview
      code={`<CodeBlock code={complexDiffCodeSample} isDiff lang="css" showLineNumbers />`}
      label="Using a diff with syntax highlighting"
      lang="astro"
    >
      <CodeBlockComponent
        code={complexDiffCodeSample}
        isDiff
        lang="css"
        showLineNumbers
      />
    </CodePreview>
  </Fragment>
</PageLayout>
